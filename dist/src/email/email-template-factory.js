"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.EmailTemplateFactory = void 0;
const call_to_action_email_template_1 = require("./call-to-action.email-template");
const config_1 = require("../config");
class EmailTemplateFactory {
    static createCallToActionEmailTemplate(subject, toName, toEmail, data) {
        const emailTemplate = new call_to_action_email_template_1.CallToActionEmailTemplate();
        emailTemplate.subject = subject;
        emailTemplate.to = {
            name: toName,
            email: toEmail
        };
        emailTemplate.templateId = config_1.default.email.emailTemplate.callToActionTemplateId;
        emailTemplate.templateData = data;
        return emailTemplate;
    }
    static createActivateAccountTemplate(toName, toEmail, c2aLink) {
        const subject = `Activate your ${config_1.default.app.name} account`;
        const callToActionData = {
            subject: subject,
            header: `Welcome to ${config_1.default.app.name}!`,
            text: `Please activate your account by clicking on the button below.`,
            c2aLink: c2aLink,
            c2aButton: "Activate Account"
        };
        return this.createCallToActionEmailTemplate(subject, toName, toEmail, callToActionData);
    }
    static createResetPasswordRequestTemplate(toName, toEmail, c2aLink) {
        const subject = `${config_1.default.app.name} password reset request`;
        const callToActionData = {
            subject: subject,
            header: `Password reset request`,
            text: `A request has been received to change the password for your ${config_1.default.app.name} account.`,
            c2aLink: c2aLink,
            c2aButton: "Reset Password"
        };
        return this.createCallToActionEmailTemplate(subject, toName, toEmail, callToActionData);
    }
    static createInviteeRequestTemplate(toName, toEmail, inviteeForm) {
        const subject = `${config_1.default.app.name} - Create Invitee Request`;
        const callToActionData = {
            subject: subject,
            header: `New Request !`,
            text: `Please verify the invitation below`,
            firstName: inviteeForm.firstName,
            lastName: inviteeForm.lastName,
            category: inviteeForm.category,
            type: inviteeForm.type,
            stageName: inviteeForm.stageName,
            requestedByEmail: inviteeForm.requestedByEmail,
            requestedByName: inviteeForm.requestedByName,
            c2aButton: 'Verify',
            c2aLink: config_1.default.app.baseAddress + '/admin-panel/verify-invitee/' + inviteeForm._id,
            country: inviteeForm.country
        };
        return this.createCallToActionEmailTemplate(subject, toName, toEmail, callToActionData);
    }
    static createInvitePlayerTemplate(toName, toEmail, inviteeForm) {
        const subject = `${config_1.default.app.name} - Golf Tournament Invitation`;
        const callToActionData = {
            subject: subject,
            header: ``,
            text: `Dear ${inviteeForm.firstName}, You have been invited to play in Golf Tournament - ${inviteeForm.tournamentName}.`,
            c2aButton: 'Register Now !',
            c2aLink: inviteeForm.url,
            country: inviteeForm.country
        };
        return this.createCallToActionEmailTemplate(subject, toName, toEmail, callToActionData);
    }
    static createNotifyClubTemplate(clubEmailInfo) {
        const subject = clubEmailInfo.clubName + ' - ' + clubEmailInfo.subject;
        const callToActionData = {
            subject: subject,
            header: `Update Golf Club Details !`,
            text: clubEmailInfo.body,
            c2aButton: 'Update',
            c2aLink: clubEmailInfo.golfClubPageUrl,
            clubName: clubEmailInfo.clubName,
            country: clubEmailInfo.countryCode,
        };
        return this.createCallToActionEmailTemplate(subject, clubEmailInfo.clubName, clubEmailInfo.clubEmail, callToActionData);
    }
    static createGolfClubUpdateNotificationTemplete(clubInfo, operation) {
        let subject = '';
        if (operation === 'add') {
            subject = 'New Golf Club Added - ' + clubInfo.name;
        }
        else if (operation === 'delete') {
            subject = 'Golf Club Deleted - ' + clubInfo.name;
        }
        else {
            subject = 'Golf Club Updated - ' + clubInfo.name;
        }
        const callToActionData = {
            subject: subject,
            header: `Golf Club Details !`,
            text: 'Greeting from PLeace Golf, Below Golf Club is updated in pleacegolf.world app.',
            c2aButton: 'Have a look !',
            c2aLink: clubInfo.golfClubPageUrl,
            clubName: clubInfo.name,
            country: clubInfo.countryCode,
            actionBy: clubInfo.actionBy
        };
        return this.createCallToActionEmailTemplate(subject, clubInfo.name, clubInfo.email, callToActionData);
    }
    static createNeedHelpTemplete(needHelpForm, toName, toEmail) {
        const subject = 'PLeace Golf - Need Help';
        const callToActionData = {
            subject: subject,
            header: `Need Help in PLeace Golf !`,
            text: 'Someone need your help in PLeace Golf app. Below are details',
            c2aButton: 'Go to app',
            c2aLink: 'pleacegolf.world',
            clubName: needHelpForm.club,
            country: needHelpForm.country,
            requestedByName: needHelpForm.requestedByName,
            regarding: needHelpForm.regarding,
            requestedByEmail: needHelpForm.requestedByEmail,
            details: needHelpForm.details
        };
        return this.createCallToActionEmailTemplate(subject, toName, toEmail, callToActionData);
    }
    static createHelpSupportTemplete(needHelpForm, toName, toEmail) {
        let subject = 'PLeace Golf - Help & Support';
        if (needHelpForm.app === 'pleace-awaken.me') {
            subject = 'PLeace Awaken(me) - Contact';
        }
        const callToActionData = {
            subject: subject,
            header: needHelpForm.subject,
            text: needHelpForm.message,
            requestedByName: needHelpForm.name ? needHelpForm.name : needHelpForm.firstName + ' ' + needHelpForm.lastName,
            requestedByEmail: needHelpForm.email1 ? needHelpForm.email1 : needHelpForm.email
        };
        return this.createCallToActionEmailTemplate(subject, toName, toEmail, callToActionData);
    }
}
exports.EmailTemplateFactory = EmailTemplateFactory;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW1haWwtdGVtcGxhdGUtZmFjdG9yeS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9lbWFpbC9lbWFpbC10ZW1wbGF0ZS1mYWN0b3J5LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLG1GQUE4RjtBQUM5RixzQ0FBK0I7QUFFL0IsTUFBYSxvQkFBb0I7SUFFdEIsTUFBTSxDQUFDLCtCQUErQixDQUFDLE9BQWUsRUFBRSxNQUFjLEVBQUUsT0FBZSxFQUFFLElBQXNCO1FBRWxILE1BQU0sYUFBYSxHQUFHLElBQUkseURBQXlCLEVBQUUsQ0FBQztRQUN0RCxhQUFhLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztRQUNoQyxhQUFhLENBQUMsRUFBRSxHQUFHO1lBQ2YsSUFBSSxFQUFFLE1BQU07WUFDWixLQUFLLEVBQUUsT0FBTztTQUNqQixDQUFDO1FBQ0YsYUFBYSxDQUFDLFVBQVUsR0FBRyxnQkFBTSxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsc0JBQXNCLENBQUM7UUFDN0UsYUFBYSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUM7UUFFbEMsT0FBTyxhQUFhLENBQUM7SUFDekIsQ0FBQztJQUVNLE1BQU0sQ0FBQyw2QkFBNkIsQ0FBQyxNQUFjLEVBQUUsT0FBZSxFQUFFLE9BQWU7UUFFeEYsTUFBTSxPQUFPLEdBQUcsaUJBQWlCLGdCQUFNLENBQUMsR0FBRyxDQUFDLElBQUksVUFBVSxDQUFDO1FBRTNELE1BQU0sZ0JBQWdCLEdBQUc7WUFDckIsT0FBTyxFQUFFLE9BQU87WUFDaEIsTUFBTSxFQUFFLGNBQWMsZ0JBQU0sQ0FBQyxHQUFHLENBQUMsSUFBSSxHQUFHO1lBQ3hDLElBQUksRUFBRSwrREFBK0Q7WUFDckUsT0FBTyxFQUFFLE9BQU87WUFDaEIsU0FBUyxFQUFFLGtCQUFrQjtTQUNaLENBQUM7UUFFdEIsT0FBTyxJQUFJLENBQUMsK0JBQStCLENBQ3ZDLE9BQU8sRUFDUCxNQUFNLEVBQ04sT0FBTyxFQUNQ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QUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsS0FBSztTQUMvRCxDQUFDO1FBRXRCLE9BQU8sSUFBSSxDQUFDLCtCQUErQixDQUN2QyxPQUFPLEVBQ1AsTUFBTSxFQUNOLE9BQU8sRUFDUCxnQkFBZ0IsQ0FDbkIsQ0FBQztJQUNOLENBQUM7Q0FDSjtBQXZNRCxvREF1TUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDYWxsVG9BY3Rpb25FbWFpbFRlbXBsYXRlLCBDYWxsVG9BY3Rpb25EYXRhIH0gZnJvbSBcIi4vY2FsbC10by1hY3Rpb24uZW1haWwtdGVtcGxhdGVcIjtcclxuaW1wb3J0IGNvbmZpZyBmcm9tIFwiLi4vY29uZmlnXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgRW1haWxUZW1wbGF0ZUZhY3Rvcnkge1xyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgY3JlYXRlQ2FsbFRvQWN0aW9uRW1haWxUZW1wbGF0ZShzdWJqZWN0OiBzdHJpbmcsIHRvTmFtZTogc3RyaW5nLCB0b0VtYWlsOiBzdHJpbmcsIGRhdGE6IENhbGxUb0FjdGlvbkRhdGEpOiBDYWxsVG9BY3Rpb25FbWFpbFRlbXBsYXRlIHtcclxuXHJcbiAgICAgICAgY29uc3QgZW1haWxUZW1wbGF0ZSA9IG5ldyBDYWxsVG9BY3Rpb25FbWFpbFRlbXBsYXRlKCk7XHJcbiAgICAgICAgZW1haWxUZW1wbGF0ZS5zdWJqZWN0ID0gc3ViamVjdDtcclxuICAgICAgICBlbWFpbFRlbXBsYXRlLnRvID0ge1xyXG4gICAgICAgICAgICBuYW1lOiB0b05hbWUsXHJcbiAgICAgICAgICAgIGVtYWlsOiB0b0VtYWlsXHJcbiAgICAgICAgfTtcclxuICAgICAgICBlbWFpbFRlbXBsYXRlLnRlbXBsYXRlSWQgPSBjb25maWcuZW1haWwuZW1haWxUZW1wbGF0ZS5jYWxsVG9BY3Rpb25UZW1wbGF0ZUlkO1xyXG4gICAgICAgIGVtYWlsVGVtcGxhdGUudGVtcGxhdGVEYXRhID0gZGF0YTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGVtYWlsVGVtcGxhdGU7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBjcmVhdGVBY3RpdmF0ZUFjY291bnRUZW1wbGF0ZSh0b05hbWU6IHN0cmluZywgdG9FbWFpbDogc3RyaW5nLCBjMmFMaW5rOiBzdHJpbmcpOiBDYWxsVG9BY3Rpb25FbWFpbFRlbXBsYXRlIHtcclxuXHJcbiAgICAgICAgY29uc3Qgc3ViamVjdCA9IGBBY3RpdmF0ZSB5b3VyICR7Y29uZmlnLmFwcC5uYW1lfSBhY2NvdW50YDtcclxuXHJcbiAgICAgICAgY29uc3QgY2FsbFRvQWN0aW9uRGF0YSA9IHtcclxuICAgICAgICAgICAgc3ViamVjdDogc3ViamVjdCxcclxuICAgICAgICAgICAgaGVhZGVyOiBgV2VsY29tZSB0byAke2NvbmZpZy5hcHAubmFtZX0hYCxcclxuICAgICAgICAgICAgdGV4dDogYFBsZWFzZSBhY3RpdmF0ZSB5b3VyIGFjY291bnQgYnkgY2xpY2tpbmcgb24gdGhlIGJ1dHRvbiBiZWxvdy5gLFxyXG4gICAgICAgICAgICBjMmFMaW5rOiBjMmFMaW5rLFxyXG4gICAgICAgICAgICBjMmFCdXR0b246IFwiQWN0aXZhdGUgQWNjb3VudFwiXHJcbiAgICAgICAgfSBhcyBDYWxsVG9BY3Rpb25EYXRhO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVDYWxsVG9BY3Rpb25FbWFpbFRlbXBsYXRlKFxyXG4gICAgICAgICAgICBzdWJqZWN0LFxyXG4gICAgICAgICAgICB0b05hbWUsXHJcbiAgICAgICAgICAgIHRvRW1haWwsXHJcbiAgICAgICAgICAgIGNhbGxUb0FjdGlvbkRhdGFcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgY3JlYXRlUmVzZXRQYXNzd29yZFJlcXVlc3RUZW1wbGF0ZSh0b05hbWU6IHN0cmluZywgdG9FbWFpbDogc3RyaW5nLCBjMmFMaW5rOiBzdHJpbmcpOiBDYWxsVG9BY3Rpb25FbWFpbFRlbXBsYXRlIHtcclxuXHJcbiAgICAgICAgY29uc3Qgc3ViamVjdCA9IGAke2NvbmZpZy5hcHAubmFtZX0gcGFzc3dvcmQgcmVzZXQgcmVxdWVzdGA7XHJcblxyXG4gICAgICAgIGNvbnN0IGNhbGxUb0FjdGlvbkRhdGEgPSB7XHJcbiAgICAgICAgICAgIHN1YmplY3Q6IHN1YmplY3QsXHJcbiAgICAgICAgICAgIGhlYWRlcjogYFBhc3N3b3JkIHJlc2V0IHJlcXVlc3RgLFxyXG4gICAgICAgICAgICB0ZXh0OiBgQSByZXF1ZXN0IGhhcyBiZWVuIHJlY2VpdmVkIHRvIGNoYW5nZSB0aGUgcGFzc3dvcmQgZm9yIHlvdXIgJHtjb25maWcuYXBwLm5hbWV9IGFjY291bnQuYCxcclxuICAgICAgICAgICAgYzJhTGluazogYzJhTGluayxcclxuICAgICAgICAgICAgYzJhQnV0dG9uOiBcIlJlc2V0IFBhc3N3b3JkXCJcclxuICAgICAgICB9IGFzIENhbGxUb0FjdGlvbkRhdGE7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUNhbGxUb0FjdGlvbkVtYWlsVGVtcGxhdGUoXHJcbiAgICAgICAgICAgIHN1YmplY3QsXHJcbiAgICAgICAgICAgIHRvTmFtZSxcclxuICAgICAgICAgICAgdG9FbWFpbCxcclxuICAgICAgICAgICAgY2FsbFRvQWN0aW9uRGF0YVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBjcmVhdGVJbnZpdGVlUmVxdWVzdFRlbXBsYXRlKHRvTmFtZTogc3RyaW5nLCB0b0VtYWlsOiBzdHJpbmcsIGludml0ZWVGb3JtOiBhbnkpOiBDYWxsVG9BY3Rpb25FbWFpbFRlbXBsYXRlIHtcclxuXHJcbiAgICAgICAgY29uc3Qgc3ViamVjdCA9IGAke2NvbmZpZy5hcHAubmFtZX0gLSBDcmVhdGUgSW52aXRlZSBSZXF1ZXN0YDtcclxuXHJcbiAgICAgICAgY29uc3QgY2FsbFRvQWN0aW9uRGF0YSA9IHtcclxuICAgICAgICAgICAgc3ViamVjdDogc3ViamVjdCxcclxuICAgICAgICAgICAgaGVhZGVyOiBgTmV3IFJlcXVlc3QgIWAsXHJcbiAgICAgICAgICAgIHRleHQ6IGBQbGVhc2UgdmVyaWZ5IHRoZSBpbnZpdGF0aW9uIGJlbG93YCxcclxuICAgICAgICAgICAgZmlyc3ROYW1lOiBpbnZpdGVlRm9ybS5maXJzdE5hbWUsXHJcbiAgICAgICAgICAgIGxhc3ROYW1lOiBpbnZpdGVlRm9ybS5sYXN0TmFtZSxcclxuICAgICAgICAgICAgY2F0ZWdvcnk6IGludml0ZWVGb3JtLmNhdGVnb3J5LFxyXG4gICAgICAgICAgICB0eXBlOiBpbnZpdGVlRm9ybS50eXBlLFxyXG4gICAgICAgICAgICBzdGFnZU5hbWU6IGludml0ZWVGb3JtLnN0YWdlTmFtZSxcclxuICAgICAgICAgICAgcmVxdWVzdGVkQnlFbWFpbDppbnZpdGVlRm9ybS5yZXF1ZXN0ZWRCeUVtYWlsLFxyXG4gICAgICAgICAgICByZXF1ZXN0ZWRCeU5hbWU6aW52aXRlZUZvcm0ucmVxdWVzdGVkQnlOYW1lLFxyXG4gICAgICAgICAgICBjMmFCdXR0b246J1ZlcmlmeScsXHJcbiAgICAgICAgICAgIGMyYUxpbms6Y29uZmlnLmFwcC5iYXNlQWRkcmVzcysnL2FkbWluLXBhbmVsL3ZlcmlmeS1pbnZpdGVlLycraW52aXRlZUZvcm0uX2lkLFxyXG4gICAgICAgICAgICBjb3VudHJ5Omludml0ZWVGb3JtLmNvdW50cnlcclxuICAgICAgICB9IGFzIENhbGxUb0FjdGlvbkRhdGE7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUNhbGxUb0FjdGlvbkVtYWlsVGVtcGxhdGUoXHJcbiAgICAgICAgICAgIHN1YmplY3QsXHJcbiAgICAgICAgICAgIHRvTmFtZSxcclxuICAgICAgICAgICAgdG9FbWFpbCxcclxuICAgICAgICAgICAgY2FsbFRvQWN0aW9uRGF0YVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgY3JlYXRlSW52aXRlUGxheWVyVGVtcGxhdGUodG9OYW1lOiBzdHJpbmcsIHRvRW1haWw6IHN0cmluZywgaW52aXRlZUZvcm06IGFueSk6IENhbGxUb0FjdGlvbkVtYWlsVGVtcGxhdGUge1xyXG5cclxuICAgICAgICBjb25zdCBzdWJqZWN0ID0gYCR7Y29uZmlnLmFwcC5uYW1lfSAtIEdvbGYgVG91cm5hbWVudCBJbnZpdGF0aW9uYDtcclxuXHJcbiAgICAgICAgY29uc3QgY2FsbFRvQWN0aW9uRGF0YSA9IHtcclxuICAgICAgICAgICAgc3ViamVjdDogc3ViamVjdCxcclxuICAgICAgICAgICAgaGVhZGVyOiBgYCxcclxuICAgICAgICAgICAgdGV4dDogYERlYXIgJHtpbnZpdGVlRm9ybS5maXJzdE5hbWV9LCBZb3UgaGF2ZSBiZWVuIGludml0ZWQgdG8gcGxheSBpbiBHb2xmIFRvdXJuYW1lbnQgLSAke2ludml0ZWVGb3JtLnRvdXJuYW1lbnROYW1lfS5gLFxyXG4gICAgICAgICAgICBjMmFCdXR0b246J1JlZ2lzdGVyIE5vdyAhJyxcclxuICAgICAgICAgICAgYzJhTGluazppbnZpdGVlRm9ybS51cmwsXHJcbiAgICAgICAgICAgIGNvdW50cnk6aW52aXRlZUZvcm0uY291bnRyeVxyXG4gICAgICAgIH0gYXMgQ2FsbFRvQWN0aW9uRGF0YTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlQ2FsbFRvQWN0aW9uRW1haWxUZW1wbGF0ZShcclxuICAgICAgICAgICAgc3ViamVjdCxcclxuICAgICAgICAgICAgdG9OYW1lLFxyXG4gICAgICAgICAgICB0b0VtYWlsLFxyXG4gICAgICAgICAgICBjYWxsVG9BY3Rpb25EYXRhXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIGNyZWF0ZU5vdGlmeUNsdWJUZW1wbGF0ZShjbHViRW1haWxJbmZvOiBhbnkpOiBDYWxsVG9BY3Rpb25FbWFpbFRlbXBsYXRlIHtcclxuXHJcbiAgICAgICAgY29uc3Qgc3ViamVjdCA9IGNsdWJFbWFpbEluZm8uY2x1Yk5hbWUgKycgLSAnK2NsdWJFbWFpbEluZm8uc3ViamVjdDtcclxuICAgICAgICBjb25zdCBjYWxsVG9BY3Rpb25EYXRhID0ge1xyXG4gICAgICAgICAgICBzdWJqZWN0OiBzdWJqZWN0LFxyXG4gICAgICAgICAgICBoZWFkZXI6IGBVcGRhdGUgR29sZiBDbHViIERldGFpbHMgIWAsXHJcbiAgICAgICAgICAgIHRleHQ6IGNsdWJFbWFpbEluZm8uYm9keSxcclxuICAgICAgICAgICAgYzJhQnV0dG9uOidVcGRhdGUnLFxyXG4gICAgICAgICAgICBjMmFMaW5rOmNsdWJFbWFpbEluZm8uZ29sZkNsdWJQYWdlVXJsLFxyXG4gICAgICAgICAgICBjbHViTmFtZTogY2x1YkVtYWlsSW5mby5jbHViTmFtZSxcclxuICAgICAgICAgICAgY291bnRyeSA6IGNsdWJFbWFpbEluZm8uY291bnRyeUNvZGUsXHJcbiAgICAgICAgfSBhcyBDYWxsVG9BY3Rpb25EYXRhO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVDYWxsVG9BY3Rpb25FbWFpbFRlbXBsYXRlKFxyXG4gICAgICAgICAgICBzdWJqZWN0LFxyXG4gICAgICAgICAgICBjbHViRW1haWxJbmZvLmNsdWJOYW1lLFxyXG4gICAgICAgICAgICBjbHViRW1haWxJbmZvLmNsdWJFbWFpbCxcclxuICAgICAgICAgICAgY2FsbFRvQWN0aW9uRGF0YVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBjcmVhdGVHb2xmQ2x1YlVwZGF0ZU5vdGlmaWNhdGlvblRlbXBsZXRlKGNsdWJJbmZvOiBhbnksb3BlcmF0aW9uOnN0cmluZyk6IENhbGxUb0FjdGlvbkVtYWlsVGVtcGxhdGUge1xyXG4gICAgICAgIGxldCBzdWJqZWN0ID0gJyc7XHJcbiAgICAgICAgaWYob3BlcmF0aW9uID09PSAnYWRkJykge1xyXG4gICAgICAgICAgICBzdWJqZWN0ID0gJ05ldyBHb2xmIENsdWIgQWRkZWQgLSAnKyBjbHViSW5mby5uYW1lO1xyXG4gICAgICAgIH0gZWxzZSBpZihvcGVyYXRpb24gPT09ICdkZWxldGUnKSB7XHJcbiAgICAgICAgICAgIHN1YmplY3QgPSAnR29sZiBDbHViIERlbGV0ZWQgLSAnKyBjbHViSW5mby5uYW1lO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHN1YmplY3QgPSAnR29sZiBDbHViIFVwZGF0ZWQgLSAnKyBjbHViSW5mby5uYW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBjYWxsVG9BY3Rpb25EYXRhID0ge1xyXG4gICAgICAgICAgICBzdWJqZWN0OiBzdWJqZWN0LFxyXG4gICAgICAgICAgICBoZWFkZXI6IGBHb2xmIENsdWIgRGV0YWlscyAhYCxcclxuICAgICAgICAgICAgdGV4dDogJ0dyZWV0aW5nIGZyb20gUExlYWNlIEdvbGYsIEJlbG93IEdvbGYgQ2x1YiBpcyB1cGRhdGVkIGluIHBsZWFjZWdvbGYud29ybGQgYXBwLicsXHJcbiAgICAgICAgICAgIGMyYUJ1dHRvbjonSGF2ZSBhIGxvb2sgIScsXHJcbiAgICAgICAgICAgIGMyYUxpbms6Y2x1YkluZm8uZ29sZkNsdWJQYWdlVXJsLFxyXG4gICAgICAgICAgICBjbHViTmFtZTogY2x1YkluZm8ubmFtZSxcclxuICAgICAgICAgICAgY291bnRyeSA6IGNsdWJJbmZvLmNvdW50cnlDb2RlLFxyXG4gICAgICAgICAgICBhY3Rpb25CeTogY2x1YkluZm8uYWN0aW9uQnlcclxuICAgICAgICB9IGFzIENhbGxUb0FjdGlvbkRhdGE7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUNhbGxUb0FjdGlvbkVtYWlsVGVtcGxhdGUoXHJcbiAgICAgICAgICAgIHN1YmplY3QsXHJcbiAgICAgICAgICAgIGNsdWJJbmZvLm5hbWUsXHJcbiAgICAgICAgICAgIGNsdWJJbmZvLmVtYWlsLFxyXG4gICAgICAgICAgICBjYWxsVG9BY3Rpb25EYXRhXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIGNyZWF0ZU5lZWRIZWxwVGVtcGxldGUobmVlZEhlbHBGb3JtOiBhbnksdG9OYW1lOiBzdHJpbmcsIHRvRW1haWw6IHN0cmluZyk6IENhbGxUb0FjdGlvbkVtYWlsVGVtcGxhdGUge1xyXG4gICAgICAgIGNvbnN0IHN1YmplY3QgPSAnUExlYWNlIEdvbGYgLSBOZWVkIEhlbHAnO1xyXG4gICAgICAgIGNvbnN0IGNhbGxUb0FjdGlvbkRhdGEgPSB7XHJcbiAgICAgICAgICAgIHN1YmplY3Q6IHN1YmplY3QsXHJcbiAgICAgICAgICAgIGhlYWRlcjogYE5lZWQgSGVscCBpbiBQTGVhY2UgR29sZiAhYCxcclxuICAgICAgICAgICAgdGV4dDogJ1NvbWVvbmUgbmVlZCB5b3VyIGhlbHAgaW4gUExlYWNlIEdvbGYgYXBwLiBCZWxvdyBhcmUgZGV0YWlscycsXHJcbiAgICAgICAgICAgIGMyYUJ1dHRvbjonR28gdG8gYXBwJyxcclxuICAgICAgICAgICAgYzJhTGluazoncGxlYWNlZ29sZi53b3JsZCcsXHJcbiAgICAgICAgICAgIGNsdWJOYW1lOiBuZWVkSGVscEZvcm0uY2x1YixcclxuICAgICAgICAgICAgY291bnRyeSA6IG5lZWRIZWxwRm9ybS5jb3VudHJ5LFxyXG4gICAgICAgICAgICByZXF1ZXN0ZWRCeU5hbWU6IG5lZWRIZWxwRm9ybS5yZXF1ZXN0ZWRCeU5hbWUsXHJcbiAgICAgICAgICAgIHJlZ2FyZGluZzogbmVlZEhlbHBGb3JtLnJlZ2FyZGluZyxcclxuICAgICAgICAgICAgcmVxdWVzdGVkQnlFbWFpbDogbmVlZEhlbHBGb3JtLnJlcXVlc3RlZEJ5RW1haWwsXHJcbiAgICAgICAgICAgIGRldGFpbHMgOiBuZWVkSGVscEZvcm0uZGV0YWlsc1xyXG4gICAgICAgIH0gYXMgQ2FsbFRvQWN0aW9uRGF0YTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlQ2FsbFRvQWN0aW9uRW1haWxUZW1wbGF0ZShcclxuICAgICAgICAgICAgc3ViamVjdCxcclxuICAgICAgICAgICAgdG9OYW1lLFxyXG4gICAgICAgICAgICB0b0VtYWlsLFxyXG4gICAgICAgICAgICBjYWxsVG9BY3Rpb25EYXRhXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIGNyZWF0ZUhlbHBTdXBwb3J0VGVtcGxldGUobmVlZEhlbHBGb3JtOiBhbnksdG9OYW1lOiBzdHJpbmcsIHRvRW1haWw6IHN0cmluZyk6IENhbGxUb0FjdGlvbkVtYWlsVGVtcGxhdGUge1xyXG4gICAgICAgIGxldCBzdWJqZWN0ID0gJ1BMZWFjZSBHb2xmIC0gSGVscCAmIFN1cHBvcnQnO1xyXG4gICAgICAgIGlmKG5lZWRIZWxwRm9ybS5hcHAgPT09ICdwbGVhY2UtYXdha2VuLm1lJykge1xyXG4gICAgICAgICAgICBzdWJqZWN0ID0gJ1BMZWFjZSBBd2FrZW4obWUpIC0gQ29udGFjdCc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGNhbGxUb0FjdGlvbkRhdGEgPSB7XHJcbiAgICAgICAgICAgIHN1YmplY3Q6IHN1YmplY3QsXHJcbiAgICAgICAgICAgIGhlYWRlcjogbmVlZEhlbHBGb3JtLnN1YmplY3QsXHJcbiAgICAgICAgICAgIHRleHQ6IG5lZWRIZWxwRm9ybS5tZXNzYWdlLFxyXG4gICAgICAgICAgICByZXF1ZXN0ZWRCeU5hbWU6IG5lZWRIZWxwRm9ybS5uYW1lID8gbmVlZEhlbHBGb3JtLm5hbWUgOiAgbmVlZEhlbHBGb3JtLmZpcnN0TmFtZSArICcgJysgbmVlZEhlbHBGb3JtLmxhc3ROYW1lLFxyXG4gICAgICAgICAgICByZXF1ZXN0ZWRCeUVtYWlsOiBuZWVkSGVscEZvcm0uZW1haWwxID8gbmVlZEhlbHBGb3JtLmVtYWlsMSA6IG5lZWRIZWxwRm9ybS5lbWFpbFxyXG4gICAgICAgIH0gYXMgQ2FsbFRvQWN0aW9uRGF0YTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlQ2FsbFRvQWN0aW9uRW1haWxUZW1wbGF0ZShcclxuICAgICAgICAgICAgc3ViamVjdCxcclxuICAgICAgICAgICAgdG9OYW1lLFxyXG4gICAgICAgICAgICB0b0VtYWlsLFxyXG4gICAgICAgICAgICBjYWxsVG9BY3Rpb25EYXRhXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufSJdfQ==